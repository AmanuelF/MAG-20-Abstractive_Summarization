In this paper, the optimal output regulation problem for partially model-free heterogeneous linear multiagent systems with disturbance generated by an exosystem is addressed by using adaptive dynamic programming and double compensator method. The topology graph for the information exchange of the agents has a spanning tree. The dynamic of individual agent is assumed to be nonidentical and of different dimensions. One distributed compensator is designed to deal with the nonidentical agents, and the other compensator is used to handle the optimal performance index. By constructing the double compensator, the distributed feedback control laws are designed to make the output of each agent synchronize with the reference output and minimize the energy of the output error simultaneously. To overcome the lack of the dynamics knowledge of each agent, a novel online policy iteration algorithm is developed to obtain the optimal feedback gain matrix. Finally, two examples are presented to illustrate the effectiveness of our results.