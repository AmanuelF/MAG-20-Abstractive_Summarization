In this paper, we investigate the multiparty output consensus of linear heterogeneous agents, in which the outputs of the agents within a party synchronize to each other, but different parties have different synchronized trajectories. To solve this problem, graphs with complex edge weights are used. We provide a sufficient condition for leader-follower multiparty output consensus of linear heterogeneous agents. We also give a similar sufficient condition for multiparty state consensus of linear homogeneous agents as homogeneous agents could be considered as a special case of heterogeneous agents. As one direct application of our theory, we provide a solution to formation control of linear heterogeneous agents, where the position of each follower agent in the formation is described by two key pieces of information: A fixed orientation of the follower's location with respect to the leader's location (within a given coordinate system), and a time-variant formation constraint (such as the relative distance) between the leader and the follower, which is captured by some linear command generator. We present sufficient conditions for both simultaneous formation and reference trajectory tracking via the internal model principle.