Formation control of multiple agents has attracted many robotic and control researchers recently because of its potential applications in various fields. This paper presents a novel approach to the formation control and obstacle avoidance of multiple rectangular agents with limited communication ranges. The distributed control algorithm is designed by utilizing an artificial potential function. The convergence and stability analysis of the proposed control algorithm is given. The proposed control algorithm can guarantee fast formation performance and no collision among agents. Also, by proposing a potential repulsive function and utilizing it as an obstacle avoidance function, rectangular agents can perfectly avoid obstacles with different shapes and sizes. As a result, the rectangular agents can move together and quickly form a pre-defined shape of formation, such as a straight line, circle, and lattice, etc., while avoiding the obstacles. Simulation results are conducted to demonstrate the effectiveness of the proposed algorithm.