Driven by smart grid technologies, distributed energy resources (DERs) have been rapidly developing in recent years for improving reliability and efficiency of distribution systems. Emerging DERs require effective and efficient coordination in order to reap their potential benefits. In this paper, we consider an optimal DER coordination problem over multiple time periods subject to constraints at both system and device levels. Fully distributed algorithms are proposed to dynamically and automatically coordinate distributed generators with multiple/single storages. With the proposed algorithms, the coordination agent at each DER maintains only a set of variables and updates them through information exchange with a few neighbors. We show that the proposed algorithms with properly chosen parameters solve the DER coordination problem as long as the underlying communication network is connected. The simulation results are used to illustrate and validate the proposed method.