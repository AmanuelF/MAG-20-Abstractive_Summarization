This paper proposes a multiagent-based optimal microgrid control scheme using a fully distributed diffusion strategy. A two-level cooperative optimization multiagent system is adapted for distributed energy resources economic dispatch. The lower level implements an adaptive droop scheme based on online no-load frequency adjustments. The upper level implements distributed communication using diffusion between neighboring agents for optimal microgrid management. The proposed control scheme enables peer-to-peer communication among the agents without the necessity of a centralized controller, and simultaneously performs resource optimization while regulating the system frequency. The results are compared with centralized and consensus-based optimization algorithms. We have concluded that the proposed algorithm is superior over consensus algorithms in terms of convergence speed and utilizes reduced communication infrastructure compared to centralized controllers. Simulation demonstrations were conducted along with experimental results from a hardware-based microgrid using an industrial multiagent framework. The simulation and experimental results show that the proposed method and the agent framework can be deployed in real-world microgrids and offer superior decision making on optimal microgrid control.